var Enemy = function (params) {
	var scope = this;

	scope.shooter = params.shooter;
	scope.canvas = scope.shooter.canvas;
	scope.game = scope.shooter.game;
	scope.width = scope.shooter.width;
	scope.height = scope.shooter.height;
	scope.explosion = scope.shooter.explosion;
	

	scope.initEnemy = function () {
		var cxStart = scope.randomX(),
			cxEnd = scope.randomX(),
			data = scope.randomData(),
			t = scope.randomTime(),
			bigR = data.scale * 25,
			smallR = data.scale * 10;
		
		var addedHealth = (scope.shooter.addEnemyHealth - scope.shooter.accuracyValue);
		
		scope.enemy = scope.game.append('g')
			.classed('enemy ' + data.className, true)
			.attr('bacteria', data.className)
			.attr('lives', data.lives + addedHealth ) // lives increases on bad accuracy
			.attr('transform', 'translate(' + [cxStart, -bigR] + ')');
		
		scope.shooter.updateResistance(addedHealth/scope.shooter.addEnemyHealth*100);

		scope.enemy
			.transition()
			.duration(t)
				.ease('linear')
				.attr('transform', 'translate(' + [cxEnd, scope.height + bigR] + ')')
				.remove();
		
		var container = d3.select('.container');
		if (container.classed('dark')) 
		{
			var enemyType = Math.floor(Math.random() * 4) + 1 ;
			if (enemyType == 4) { 
				// bacteria
				scope.enemy.append('path')
				.classed('lg', true)
				.attr('transform', 'scale(' + data.scale + ') rotate(' + Math.floor(Math.random() * 360) + ')')
				.attr('d','m47.376188,0.627149c1.0186,-0.453832 2.311517,0.14926 2.634241,1.212235c1.212235,3.866647 2.390181,7.745396 3.594348,11.61406c0.488121,1.530926 1.486551,2.904524 2.819808,3.806136c2.023081,1.417972 4.804566,1.708425 7.057589,0.673688c0.72008,-0.314657 1.361495,-0.776557 1.990809,-1.244508c3.267589,-2.370011 6.517025,-4.764225 9.782597,-7.132219c1.032719,-0.810846 2.692735,-0.155311 3.007392,1.083145c0.262214,0.776557 -0.175482,1.524875 -0.42761,2.238904c-0.960106,2.547509 -1.898025,5.103086 -2.860149,7.650596c-0.4619,1.309053 -1.097264,2.589867 -1.186014,3.997754c-0.288435,3.128414 1.720527,6.2891 4.667408,7.370228c0.875391,0.340878 1.817344,0.500223 2.755263,0.469968c4.171219,-0.098834 8.34042,-0.233976 12.511639,-0.322725c0.927834,-0.022187 1.851634,0.643433 2.031149,1.573284c0.193635,0.810846 -0.217839,1.682203 -0.915732,2.113848c-3.330117,2.178393 -6.684438,4.320479 -10.002453,6.519042c-2.781485,1.906094 -3.763778,5.855439 -2.363959,8.893086c0.558717,1.27678 1.518824,2.351857 2.680633,3.112278c3.231282,2.103763 6.462565,4.203491 9.69183,6.309271c0.744284,0.457866 1.137605,1.424023 0.873374,2.265125c-0.256163,0.839085 -1.101299,1.450245 -1.980724,1.411921c-4.247866,-0.092783 -8.495731,-0.233976 -12.743597,-0.326759c-1.512773,-0.004034 -3.011426,0.504258 -4.225678,1.399819c-2.521288,1.805242 -3.675029,5.296721 -2.614071,8.229483c1.341325,3.618552 2.696769,7.231053 4.052214,10.845572c0.27835,0.697892 0.10892,1.545045 -0.421559,2.079558c-0.633347,0.675705 -1.77297,0.833033 -2.527339,0.270282c-3.059835,-2.230835 -6.115636,-4.469739 -9.177488,-6.698557c-1.105333,-0.837068 -2.238904,-1.704391 -3.608467,-2.055354c-2.79157,-0.786642 -5.984529,0.296503 -7.713124,2.626173c-1.042805,1.300985 -1.363512,2.971086 -1.861719,4.522182c-0.97826,3.106227 -1.910128,6.226572 -2.892421,9.332799c-0.340878,1.101299 -1.732629,1.674135 -2.753246,1.139622c-0.530479,-0.235993 -0.883459,-0.744284 -1.044822,-1.286865c-1.188031,-3.808153 -2.363959,-7.622357 -3.549973,-11.43051c-0.572837,-1.883906 -1.944417,-3.509633 -3.711336,-4.38099c-2.301431,-1.183997 -5.240245,-0.996413 -7.360143,0.500223c-3.495513,2.55356 -6.995061,5.107121 -10.490574,7.662698c-0.839085,0.659569 -2.184444,0.494172 -2.799638,-0.393321c-0.437696,-0.560734 -0.490138,-1.343342 -0.22389,-1.990809c1.175929,-3.088073 2.311517,-6.192283 3.479377,-9.28439c0.397355,-1.054907 0.851187,-2.115865 0.907664,-3.255487c0.201703,-2.238904 -0.762437,-4.522182 -2.444641,-5.998648c-1.286865,-1.171895 -3.025545,-1.827429 -4.764225,-1.83348c-4.239798,0.0948 -8.479595,0.231958 -12.719393,0.326759c-1.313087,0.088749 -2.416402,-1.33124 -1.980724,-2.579782c0.205737,-0.796727 0.990362,-1.177946 1.621692,-1.58942c2.973103,-1.934332 5.944188,-3.868664 8.909223,-5.815098c1.492602,-0.966157 2.636259,-2.480947 3.080005,-4.209542c0.824965,-2.97512 -0.435679,-6.396003 -3.082022,-8.021729c-3.247419,-2.12595 -6.504923,-4.239798 -9.752341,-6.367764c-0.766471,-0.494172 -1.071043,-1.543028 -0.718063,-2.380096c0.320708,-0.843119 1.264678,-1.29695 2.134018,-1.23644c4.104657,0.10892 8.209313,0.215822 12.31397,0.328776c2.194529,0.058494 4.385024,-0.952038 5.762655,-2.66248c1.587403,-1.906094 2.113848,-4.647238 1.260644,-6.98901c-1.226354,-3.322049 -2.47893,-6.636029 -3.713353,-9.956061c-0.229941,-0.643433 -0.601075,-1.313087 -0.413491,-2.01703c0.20372,-0.956072 1.190048,-1.647914 2.156205,-1.530926c0.617211,0.062528 1.099281,0.48207 1.581352,0.828999c3.257504,2.386147 6.512991,4.772294 9.774529,7.150372c1.593454,1.155758 3.66091,1.607573 5.593225,1.228371c2.285295,-0.413491 4.290223,-2.023081 5.256381,-4.128861c0.308606,-0.677722 0.498206,-1.397802 0.722097,-2.10578c1.05289,-3.404747 2.107797,-6.809494 3.166737,-10.212224c0.167414,-0.595024 0.59099,-1.119452 1.173912,-1.349393m8.705502,29.297364c-0.776557,0.213805 -1.177946,0.962123 -1.639846,1.549079c-0.463917,0.615194 -1.062975,1.270729 -0.950021,2.10578c0.062528,1.214252 1.409904,2.117882 2.559611,1.728595c0.790676,-0.211788 1.192065,-0.97826 1.662033,-1.573284c0.476019,-0.619228 1.075077,-1.300985 0.919766,-2.148137c-0.0948,-1.194082 -1.419989,-2.065439 -2.551543,-1.662033m-18.189579,2.357908c-2.23487,0.175482 -4.358802,1.353427 -5.694076,3.150601c-1.506722,1.974673 -1.990809,4.683544 -1.254593,7.055572c0.57082,1.944417 1.932315,3.642757 3.70125,4.629084c1.928281,1.109367 4.336615,1.327206 6.440378,0.613177c1.88794,-0.643433 3.515684,-2.019047 4.459654,-3.777898c1.046839,-1.88794 1.220303,-4.209542 0.546615,-6.250777c-1.085162,-3.392645 -4.643204,-5.780809 -8.199228,-5.41976m27.254113,6.474667c-0.726131,0.33281 -1.183997,1.12752 -1.131554,1.924247c0.030255,0.855221 -0.106903,1.740697 0.127073,2.573731c0.437696,1.288882 2.285295,1.702374 3.231282,0.722097c0.919766,-0.855221 0.532496,-2.210665 0.61116,-3.315998c0.137158,-1.44016 -1.55513,-2.581799 -2.837962,-1.904077m-10.311059,11.860138c-2.004928,0.399372 -3.727472,1.924247 -4.393092,3.852528c-0.90363,2.456743 0.062528,5.421777 2.242938,6.872022c2.291346,1.668084 5.750553,1.317121 7.670766,-0.762437c1.724561,-1.736663 2.160239,-4.568573 1.067009,-6.751c-1.131554,-2.406317 -3.991703,-3.812187 -6.587621,-3.211112m-28.393735,1.109367c-1.141639,0.270282 -1.597488,1.4805 -2.305466,2.285295c-0.784625,0.90363 -0.471985,2.462794 0.607126,2.985205c0.907664,0.530479 2.12595,0.151277 2.664497,-0.726131c0.578888,-0.887493 1.60959,-1.692288 1.436126,-2.870234c-0.119005,-1.121469 -1.307036,-1.958536 -2.402283,-1.674135m40.512052,6.01075c-0.72008,0.213805 -1.103316,0.90363 -1.53496,1.456296c-0.405423,0.576871 -0.974226,1.119452 -1.006498,1.869787c-0.080681,0.958089 0.613177,1.90206 1.559164,2.089643c0.859255,0.20372 1.73868,-0.264231 2.192512,-0.992379c0.540564,-0.839085 1.490585,-1.581352 1.40587,-2.676599c-0.038324,-1.254593 -1.446211,-2.184444 -2.616088,-1.746748m-29.448641,2.803672c-1.238457,0.411474 -1.71851,2.129984 -0.853204,3.114295c0.816897,1.026668 2.263108,0.679739 3.40273,0.732182c1.083145,0.086732 2.103763,-0.828999 2.113848,-1.918196c0.068579,-1.054907 -0.851187,-2.037201 -1.906094,-2.045269c-0.915732,0.012102 -1.861719,-0.119005 -2.75728,0.116988z');
			} else if (enemyType == 3) { 
				// avocado
				scope.enemy.append('path')
				.classed('lg', true)
				.attr('transform', 'scale(' + data.scale + ') rotate(' + Math.floor(Math.random() * 360) + ')')
				.attr('d','m42.93785,0.125777c1.438366,-0.434148 3.108008,0.290109 3.767344,1.64124c0.495009,0.89264 0.344884,1.939463 0.359085,2.917308c0.006086,1.76702 0.002028,3.534041 0,5.301062c2.485189,0.373285 4.879086,1.351132 6.853037,2.917308c2.353322,-2.365495 4.716789,-4.720845 7.076197,-7.080254c0.880468,-0.898726 2.30869,-1.198977 3.475208,-0.726285c1.09754,0.397631 1.89686,1.456626 2.049013,2.604885c0.150125,1.034651 -0.269821,2.105818 -1.026535,2.813843c-2.550108,2.529822 -5.065729,5.092102 -7.630039,7.607723c0.634991,1.444454 1.154345,2.935567 1.535746,4.467255c3.730827,-1.00219 7.461655,-2.004382 11.192482,-3.002514c1.525602,-0.444292 3.298709,0.458492 3.838351,1.951635c0.54167,1.3065 0.089264,2.935567 -1.044793,3.777488c-0.570072,0.452406 -1.302442,0.588331 -1.984094,0.774974c-3.611133,0.969731 -7.220236,1.939463 -10.829341,2.907165c0.379371,2.314776 0.79729,4.623467 1.186805,6.938243c3.081635,-0.570072 6.142983,-1.24158 9.224618,-1.813681c1.791366,-0.314452 3.600989,1.190862 3.667938,2.996428c0.133896,1.554004 -1.01842,3.091778 -2.554166,3.383915c-3.075549,0.639049 -6.165299,1.20912 -9.23679,1.870486c0.30228,1.691958 0.551814,3.394059 0.813519,5.094132c2.913251,-0.626877 5.812301,-1.318672 8.723523,-1.951635c1.704129,-0.409803 3.554328,0.86018 3.828207,2.58054c0.342854,1.610809 -0.756714,3.355513 -2.361437,3.732857c-3.110038,0.718169 -6.22819,1.407936 -9.342284,2.113932c0.154183,1.489085 0.261705,2.982228 0.363142,4.477399c3.260163,0.032459 6.522355,-0.008116 9.784546,0.01623c1.43228,-0.032459 2.775298,1.01842 3.124238,2.402012c0.442262,1.478941 -0.383429,3.181043 -1.789336,3.793718c-0.795261,0.391545 -1.700073,0.292137 -2.554166,0.292137c-2.992372,-0.002028 -5.982714,0.012172 -8.975084,-0.004058c-0.33474,1.649354 -0.787146,3.278421 -1.43228,4.836483c3.325082,1.777164 6.652194,3.5523 9.977276,5.331492c1.377505,0.750629 2.028726,2.568368 1.405907,4.018907c-0.608617,1.67167 -2.734723,2.54808 -4.337416,1.762962c-3.416375,-1.78325 -6.790146,-3.653736 -10.214636,-5.420756c-1.162461,1.564148 -2.493305,2.998458 -3.962103,4.278583c1.716303,2.566338 3.45492,5.120506 5.179339,7.680758c0.732371,1.040737 0.789174,2.519678 0.089264,3.590845c-0.584273,0.923071 -1.647326,1.54386 -2.750953,1.515459c-1.044793,0.006086 -2.089588,-0.523411 -2.669804,-1.395763c-1.756876,-2.594741 -3.505639,-5.195568 -5.258459,-7.792338c-2.610971,1.274041 -5.416699,2.142335 -8.303576,2.501419c-0.006086,2.300575 0.020288,4.605209 -0.012172,6.905784c-0.048689,1.734561 -1.732533,3.197272 -3.45695,3.020774c-1.65747,-0.073035 -3.063377,-1.584435 -3.024831,-3.241904c0,-2.227542 -0.004058,-4.457112 0.002028,-6.684653c-2.821959,-0.348942 -5.568854,-1.192891 -8.133163,-2.416213c-1.76702,3.030917 -3.527955,6.063863 -5.280775,9.102894c-0.643106,1.176661 -2.075387,1.819767 -3.387973,1.57632c-1.272011,-0.208958 -2.335064,-1.245638 -2.600827,-2.503449c-0.208958,-0.831777 -0.006086,-1.716303 0.43009,-2.440558c1.79948,-3.110038 3.621277,-6.21196 5.394383,-9.336198c-1.387649,-1.13 -2.596769,-2.460845 -3.710541,-3.85458c-3.40826,2.093646 -6.798262,4.217722 -10.196378,6.329626c-1.318672,0.852065 -3.241904,0.566014 -4.21975,-0.673538c-0.904812,-1.048851 -1.010306,-2.673862 -0.245476,-3.828207c0.43009,-0.722227 1.19492,-1.119858 1.884686,-1.54589c3.146555,-1.969893 6.313396,-3.907327 9.461979,-5.873162c-0.953501,-2.255943 -1.616895,-4.633611 -1.923233,-7.064025c-3.250019,0.012172 -6.500039,-0.010144 -9.750058,0.008116c-0.963645,0.036517 -1.931347,-0.35097 -2.582568,-1.063053c-1.016392,-1.073197 -1.123914,-2.848331 -0.271849,-4.049337c0.586302,-0.86018 1.608779,-1.389677 2.647488,-1.385619c3.383915,-0.008116 6.765802,-0.008116 10.147689,0.002028c0.610647,-2.4365 1.852227,-4.64984 3.187129,-6.755658c-3.34537,-1.6879 -6.708997,-3.339284 -10.046253,-5.039355c-1.584435,-0.823663 -2.138277,-3.073521 -1.144201,-4.550432c0.817577,-1.351132 2.67589,-1.917146 4.098026,-1.21115c2.890934,1.420108 5.76564,2.880792 8.650488,4.3151c0.750629,0.367199 1.52966,0.705997 2.150449,1.282155c2.067273,-2.870648 4.008764,-5.858961 5.388297,-9.127239c-0.499067,-0.11158 -0.983932,-0.273877 -1.45054,-0.482837c-3.639535,-1.574292 -7.289213,-3.118152 -10.928749,-4.694473c-1.292299,-0.531526 -2.077416,-1.996266 -1.890772,-3.369714c0.184615,-2.018582 2.529822,-3.430576 4.394221,-2.604885c3.866752,1.633125 7.715245,3.306824 11.577941,4.950093c0.166355,-1.247667 0.227218,-2.505477 0.237362,-3.763286c0.026374,-2.178853 0.523411,-4.33336 1.367361,-6.33774c-2.700235,-1.793394 -5.396411,-3.592873 -8.092588,-5.394383c-1.493143,-0.969731 -1.856285,-3.247991 -0.732371,-4.629553c0.959587,-1.330844 2.963969,-1.683843 4.323216,-0.774974c2.763124,1.827883 5.512049,3.68011 8.275175,5.507991c2.170737,-2.040899 4.913575,-3.444778 7.826825,-4.063539c0.040575,-2.343178 -0.018258,-4.686358 0.026374,-7.027507c0.050719,-1.347074 1.050881,-2.58054 2.353322,-2.917308m-5.572911,48.62451c-4.386107,0.600503 -8.10679,4.290757 -8.749896,8.668748c-0.531526,3.160755 0.495009,6.53047 2.708349,8.851333c1.675728,1.78325 3.988476,2.965998 6.424976,3.225674c3.136411,0.389515 6.414832,-0.7628 8.628173,-3.016716c2.239714,-2.227542 3.367685,-5.510021 2.963969,-8.642374c-0.342854,-3.045117 -2.130162,-5.881278 -4.708673,-7.526574c-2.12002,-1.395763 -4.763448,-1.945549 -7.266897,-1.56009z');
			} else if (enemyType == 2) { 
				// infu
				scope.enemy.append('path')
				.classed('lg', true)
				.attr('transform', 'scale(' + data.scale + ') rotate(' + Math.floor(Math.random() * 360) + ')')
				.attr('d','m43.721701,2.484765c-0.01418,-0.834569 0.717082,-1.606343 1.549624,-1.64483c0.607696,-0.022283 1.217418,-0.020257 1.827139,0.016206c0.816338,0.054693 1.525317,0.814312 1.494933,1.640779c0.020257,2.007423 0.004051,4.014845 0.006077,6.024294c1.347059,0.121539 2.677913,0.382848 3.978384,0.753543c0.860902,-1.470624 1.699523,-2.955428 2.562451,-4.424028c0.435515,-0.830518 1.592163,-1.108033 2.370015,-0.59149c0.577311,0.348412 1.227546,0.617824 1.701549,1.110059c0.435515,0.52667 0.518567,1.326802 0.158002,1.916268c-0.781902,1.355162 -1.575959,2.706273 -2.353809,4.065487c1.340982,0.905467 2.530041,2.029704 3.540842,3.293712c1.436188,-0.749492 2.854145,-1.531394 4.288309,-2.284938c0.686696,-0.3869 1.640779,-0.206616 2.10668,0.439567c0.338284,0.502363 0.601619,1.05334 0.887237,1.588113c0.445644,0.775825 0.101283,1.869678 -0.694799,2.268732c-1.357188,0.751518 -2.742735,1.452394 -4.09182,2.214039c0.89939,2.0925 1.484804,4.306539 1.853472,6.550964c1.563804,-0.166103 3.127609,-0.34031 4.691413,-0.520593c0.850774,-0.160026 1.760292,0.46185 1.90614,1.318701c0.11141,0.597567 0.17218,1.207289 0.202565,1.814985c0.050641,0.806211 -0.59149,1.58001 -1.391624,1.685343c-1.638753,0.230925 -3.289662,0.358541 -4.930441,0.571234c0.295745,2.611067 -0.06077,5.246443 -0.332207,7.847382c1.772446,0.255232 3.552997,0.459823 5.323417,0.729235c0.787979,0.131667 1.405804,0.905467 1.338957,1.7056c-0.050641,0.632003 -0.129642,1.264008 -0.257258,1.885884c-0.194462,0.798108 -1.049289,1.349085 -1.855498,1.211341c-1.788652,-0.218771 -3.571227,-0.488183 -5.357853,-0.715056c-0.51249,2.349758 -1.106007,4.68331 -1.857524,6.966222c1.606343,0.522619 3.212686,1.041186 4.819029,1.561779c0.852801,0.234976 1.403778,1.227546 1.124237,2.074269c-0.155975,0.548953 -0.324105,1.097904 -0.52667,1.632676c-0.297771,0.781902 -1.243752,1.233623 -2.035781,0.952057c-1.695472,-0.52667 -3.378789,-1.097904 -5.072237,-1.634703c-0.796082,1.924371 -1.754216,3.775818 -2.68399,5.63942c1.434163,0.753543 2.837941,1.567856 4.259949,2.345707c0.565157,0.267386 1.037134,0.787979 1.093853,1.432137c0.062796,0.822415 -0.532747,1.482778 -0.875082,2.179603c-0.374745,0.832544 -1.452394,1.261982 -2.274809,0.830518c-1.59824,-0.875082 -3.188379,-1.768395 -4.780542,-2.65158c-1.322752,1.926397 -2.765016,3.773792 -4.334899,5.505725c1.037134,0.854825 2.096551,1.683319 3.133686,2.538144c0.656312,0.508439 0.790005,1.553676 0.301822,2.220116c-0.370694,0.504387 -0.757595,1.000673 -1.182982,1.460497c-0.59149,0.597567 -1.6266,0.607696 -2.254552,0.062796c-1.150572,-0.94598 -2.329502,-1.857524 -3.469944,-2.815658c-1.663062,1.45442 -3.392969,2.829838 -5.22416,4.065487c0.812287,1.276162 1.663062,2.528016 2.46522,3.812279c0.463874,0.684671 0.257258,1.687369 -0.399054,2.173526c-0.48008,0.350438 -0.978391,0.676569 -1.488855,0.980417c-0.721132,0.437541 -1.75219,0.182309 -2.205936,-0.524644c-0.873057,-1.290341 -1.693446,-2.61917 -2.564477,-3.911537c-2.130987,1.148546 -4.332872,2.197833 -6.652246,2.906812c0.194462,1.5476 0.52667,3.074941 0.759619,4.61849c0.188386,0.846724 -0.388925,1.776498 -1.241725,1.95273c-0.595542,0.12559 -1.19311,0.243078 -1.796755,0.311951c-0.840646,0.072923 -1.652933,-0.597567 -1.766369,-1.430111c-0.261309,-1.42606 -0.471977,-2.862248 -0.743415,-4.286283c-2.426733,0.257258 -4.898029,0.249155 -7.280199,-0.328155c-0.65226,1.61242 -1.278188,3.236993 -1.924371,4.853466c-0.237002,0.692773 -0.952057,1.17893 -1.685343,1.13234c-0.629979,-0.09318 -1.201212,-0.399054 -1.794729,-0.611747c-1.130315,-0.326131 -1.503034,-1.729908 -0.915595,-2.686016c0.597567,-1.51924 1.213366,-3.032403 1.802832,-4.555694c-1.857524,-1.11816 -3.47197,-2.609042 -4.796747,-4.320719c-1.511137,0.708979 -3.02025,1.424034 -4.541515,2.11073c-0.601619,0.277515 -1.336931,0.113436 -1.814985,-0.328155c-0.476028,-0.530721 -0.670492,-1.247802 -0.988519,-1.875755c-0.405131,-0.792031 -0.044564,-1.859551 0.771774,-2.224168c1.365291,-0.644158 2.738683,-1.270085 4.101948,-1.914242c-0.862928,-2.003371 -1.424034,-4.134359 -1.675216,-6.299782c-1.428085,-0.17218 -2.862248,-0.289668 -4.284257,-0.484131c-0.794056,-0.119513 -1.419984,-0.889261 -1.363265,-1.69142c0.048616,-0.656312 0.099257,-1.314649 0.232949,-1.958807c0.208642,-0.721132 0.956108,-1.243752 1.707626,-1.172853c1.249828,0.113436 2.497631,0.257258 3.745433,0.40108c0.360567,-2.734632 1.361239,-5.449008 3.206609,-7.535431c-0.917621,-0.820389 -1.853472,-1.618497 -2.779196,-2.426733c-0.684671,-0.567183 -0.773799,-1.697498 -0.170155,-2.353809c0.40108,-0.474003 0.785954,-0.968263 1.243752,-1.389598c0.61985,-0.508439 1.586087,-0.449695 2.169475,0.089129c1.17893,1.033083 2.365964,2.058064 3.54692,3.089121c2.422681,-1.543547 4.770413,-3.22484 6.873042,-5.187699c-1.235649,-0.66644 -2.505734,-1.264008 -3.73733,-1.934498c-0.745441,-0.380823 -1.106007,-1.375418 -0.737338,-2.135039c0.259284,-0.542876 0.528696,-1.083724 0.832544,-1.602292c0.435515,-0.721132 1.460497,-0.980417 2.189732,-0.569209c1.571907,0.806211 3.141789,1.61242 4.713696,2.420655c1.800806,-2.690068 2.570554,-5.981755 2.392297,-9.198492c-1.608369,-0.03241 -3.216737,-0.062796 -4.825106,-0.083052c-0.806211,-0.008103 -1.557727,-0.664415 -1.640779,-1.470624c-0.04659,-0.615799 -0.020257,-1.233623 0.022283,-1.847395c0.026333,-0.824441 0.763672,-1.545574 1.586087,-1.557727c1.571907,-0.016206 3.14584,0.070897 4.719773,0.058744c0.192436,-2.428758 0.69885,-4.831183 1.539497,-7.118147c-1.274136,-0.55908 -2.546247,-1.124237 -3.816332,-1.695472c-0.763672,-0.301822 -1.19311,-1.237675 -0.931801,-2.011474c0.202565,-0.563132 0.457797,-1.106007 0.715056,-1.64483c0.34031,-0.757595 1.308572,-1.156649 2.07832,-0.838621c1.387572,0.57326 2.742735,1.219443 4.118153,1.814985c1.079673,-1.640779 2.396348,-3.121533 3.923691,-4.359206c-0.530721,-0.984467 -1.11816,-1.936524 -1.6266,-2.931121c-0.382848,-0.739363 -0.074949,-1.735985 0.648209,-2.141116c0.476028,-0.287642 0.962185,-0.565157 1.460497,-0.814312c0.719106,-0.384874 1.721806,-0.121539 2.130987,0.593516c0.542876,0.921672 1.07157,1.853472 1.569881,2.801479c1.99932,-0.767722 4.093846,-1.300469 6.234961,-1.470624c0.006077,-2.011474 -0.004051,-4.024974 0.004051,-6.036448m-14.576603,47.732497c-1.08575,0.4659 -1.697498,1.786626 -1.324778,2.914915c0.336258,1.17893 1.661036,1.958807 2.856171,1.648882c1.318701,-0.267386 2.191757,-1.760292 1.774472,-3.040506c-0.372721,-1.353137 -2.029704,-2.143142 -3.305866,-1.523291m5.681957,4.689387c-1.391624,0.277515 -2.449015,1.695472 -2.258603,3.11343c0.089129,1.64483 1.808908,2.914915 3.407149,2.57258c1.628626,-0.257258 2.767042,-2.080346 2.250501,-3.654279c-0.374745,-1.436188 -1.956781,-2.370015 -3.399046,-2.03173m-14.238318,3.528688c-0.743415,0.091154 -1.428085,0.575286 -1.740036,1.259956c-0.577311,1.11816 0.038487,2.623221 1.229572,3.022275c1.233623,0.52667 2.771095,-0.364618 2.965557,-1.683319c0.301822,-1.401752 -1.029033,-2.837941 -2.455092,-2.598913m16.415895,5.094518c-1.266033,0.482106 -1.930448,2.07832 -1.355162,3.311943c0.449695,1.124237 1.784601,1.788652 2.951377,1.436188c1.345034,-0.311951 2.193783,-1.865627 1.756242,-3.168122c-0.384874,-1.367315 -2.049961,-2.155296 -3.352456,-1.58001m-11.507737,1.460497c-1.282239,0.411208 -2.244425,1.616472 -2.392297,2.951377c-0.216745,1.503034 0.676569,3.060763 2.054013,3.67656c1.363265,0.644158 3.121533,0.301822 4.12423,-0.826467c1.033083,-1.091827 1.237675,-2.858198 0.496284,-4.162717c-0.798108,-1.476701 -2.69817,-2.224168 -4.282232,-1.638753m-8.702207,1.043211c-1.399727,0.471977 -2.299116,2.058064 -1.960833,3.502355c0.307899,1.614446 2.082372,2.765016 3.680613,2.325451c1.606343,-0.350438 2.700196,-2.137064 2.244425,-3.72315c-0.3869,-1.675216 -2.351784,-2.746786 -3.964204,-2.104654l0,-0.000001z');
			} else {
				scope.enemy.append('path')
				.classed('lg', true)
				.attr('transform', 'scale(' + data.scale + ') rotate(' + Math.floor(Math.random() * 360) + ')')
				.attr('d','m47.865376,2.521923c-2.646262,0 -4.794555,2.148293 -4.794555,4.794977l0,7.038474c-2.666104,0.383978 -5.235951,1.093884 -7.671753,2.052879l-3.509843,-6.099321c-1.342129,-2.282337 -4.257323,-3.069081 -6.55887,-1.74595c-2.301969,1.323553 -3.088713,4.258168 -1.764315,6.540505l3.528842,6.117686c-2.071667,1.64927 -3.951028,3.52863 -5.600297,5.600297l-6.117897,-3.52863c-2.282126,-1.323131 -5.216741,-0.537654 -6.540505,1.764315c-1.323131,2.301547 -0.536387,5.216952 1.74595,6.559081l6.09911,3.528208c-0.958995,2.417437 -1.66869,4.987072 -2.052668,7.653176l-7.038685,0c-2.646684,0 -4.794555,2.148293 -4.794555,4.794555c0,2.646473 2.147871,4.794977 4.794555,4.794977l7.038474,0c0.383978,2.666738 1.093673,5.236373 2.052668,7.652754l-6.09911,3.528842c-2.282337,1.342763 -3.069081,4.256901 -1.74595,6.55887c1.323764,2.300914 4.258379,3.085757 6.540505,1.763682l6.117897,-3.52863c1.64927,2.071244 3.52863,3.952294 5.600297,5.599875l-3.528842,6.117053c-1.324397,2.283393 -0.537443,5.218641 1.764315,6.540294c2.301547,1.324397 5.216741,0.538076 6.55887,-1.745528l3.509632,-6.098265c2.435802,0.958995 5.005648,1.66869 7.671753,2.052668l0,7.038896c0,2.646473 2.148293,4.794344 4.794555,4.794344c2.646473,0 4.794977,-2.147871 4.794977,-4.794344l0,-7.038896c2.666738,-0.383767 5.236584,-1.093673 7.67133,-2.052668l3.510265,6.098265c1.340441,2.283393 4.256901,3.069925 6.55887,1.745528c2.301125,-1.321864 3.085757,-4.256901 1.763682,-6.540294l-3.528419,-6.117053c2.071033,-1.647792 3.952083,-3.528842 5.599664,-5.599875l6.117053,3.52863c2.283393,1.322075 5.218641,0.537232 6.540505,-1.763682c1.324397,-2.301969 0.538076,-5.216108 -1.745739,-6.55887l-6.098265,-3.528842c0.958995,-2.416381 1.66869,-4.986016 2.052668,-7.652754l7.039107,0c2.646262,0 4.794133,-2.148716 4.794133,-4.794977c0,-2.646262 -2.147871,-4.794555 -4.794133,-4.794555l-7.039107,0c-0.383767,-2.666104 -1.093673,-5.235739 -2.052668,-7.653176l6.098265,-3.528208c2.283604,-1.342129 3.070136,-4.257535 1.745739,-6.559081c-1.322075,-2.301969 -4.257112,-3.087446 -6.540505,-1.764315l-6.117053,3.52863c-1.647792,-2.071667 -3.528842,-3.951028 -5.599664,-5.600297l3.528419,-6.117686c1.322075,-2.282337 0.537443,-5.216952 -1.763682,-6.540505c-2.301969,-1.323131 -5.218641,-0.536387 -6.55887,1.74595l-3.510265,6.099321c-2.434747,-0.958995 -5.004593,-1.668901 -7.67133,-2.052879l0,-7.038474c0.000422,-2.646684 -2.148082,-4.794977 -4.794555,-4.794977zm-12.466308,55.618571c0,-5.292524 4.296587,-9.58911 9.589321,-9.58911c5.293368,0 9.589321,4.296587 9.589321,9.58911c0,5.292735 -4.295953,9.589321 -9.589321,9.589321c-5.292735,-0.000211 -9.589321,-4.296587 -9.589321,-9.589321zm19.178643,-18.219858c0,-3.700882 3.011664,-6.712546 6.712968,-6.712546c3.70046,0 6.712124,3.011875 6.712124,6.712546c0,3.701727 -3.011664,6.712546 -6.712124,6.712546c-3.701516,0.000211 -6.712968,-3.010819 -6.712968,-6.712546zm-15.34245,-9.589321c0,-2.646684 2.147871,-4.794555 4.794555,-4.794555c2.646473,0 4.794555,2.147871 4.794555,4.794555c0,2.646262 -2.148293,4.794766 -4.794555,4.794766c-2.646684,0 -4.794555,-2.148293 -4.794555,-4.794766z');
			}
			

			
		} else {
			// virus
			scope.enemy.append('path')
					.classed('lg', true)
					.attr('transform', 'scale(' + data.scale + ')')
					.attr('d', 'm52.017304,4.65668l0.76326,0c1.052373,0.092516 2.081617,0.50884 2.856442,1.24897c0.959857,0.878905 1.50339,2.185698 1.468697,3.492491c-0.023129,1.561213 -0.913599,3.064603 -2.255085,3.862557c-1.156454,0.705437 -2.602022,0.821082 -3.874121,0.416323c-2.532634,2.752361 -5.053704,5.504721 -7.574774,8.257082c0.370065,0.439453 0.751695,0.867341 1.087067,1.341487c1.665294,-0.959857 3.307459,-1.977536 4.984317,-2.937393c0.069387,-1.191148 0.705437,-2.359166 1.769375,-2.948958c1.329922,-0.797953 3.180249,-0.531969 4.232622,0.612921c1.202712,1.202712 1.272099,3.295894 0.173468,4.591123c-0.982986,1.260535 -2.868006,1.6306 -4.27888,0.902034c-1.665294,0.99455 -3.330588,1.977536 -4.995882,2.960522c1.006115,2.162569 1.584342,4.510171 1.711552,6.892466c0.693872,0.034694 1.387745,0.069387 2.070053,0.092516c0.659179,-0.844211 1.734681,-1.341487 2.810183,-1.24897c1.353051,0.080952 2.567328,1.098631 2.891135,2.416989c0.265984,1.029244 0,2.197263 -0.728566,2.983651c-0.705437,0.797953 -1.827197,1.202712 -2.879571,1.040809c-0.936728,-0.12721 -1.780939,-0.705437 -2.289779,-1.491826c-0.693872,-0.046258 -1.387745,-0.069387 -2.070053,-0.104081c-0.104081,0.693872 -0.265984,1.387745 -0.427888,2.070053c2.058488,0.76326 4.105412,1.572778 6.1639,2.336037c0.878905,-0.63605 2.058488,-0.867341 3.099297,-0.543533c1.341487,0.393194 2.336037,1.653729 2.463247,3.02991l0,0.566662c-0.104081,1.12176 -0.751695,2.174134 -1.734681,2.729232c-1.168019,0.693872 -2.740796,0.601356 -3.816298,-0.231291c-0.682308,-0.497275 -1.133325,-1.272099 -1.329922,-2.093182c-2.046924,-0.797953 -4.116976,-1.572778 -6.1639,-2.359166c-1.075502,2.127875 -2.555763,4.059154 -4.359832,5.631931c1.538084,2.185698 3.099297,4.359832 4.648945,6.533965c1.156454,-0.231291 2.39386,-0.034694 3.399975,0.601356c1.063938,0.647614 1.838762,1.75781 2.093182,2.983651c0.300678,1.387745 -0.092516,2.914264 -1.029244,3.978202c-0.797953,0.936728 -1.977536,1.491826 -3.191813,1.595907l-0.589792,0c-1.468697,-0.104081 -2.868006,-0.925163 -3.64283,-2.185698c-0.925163,-1.445568 -0.902034,-3.376846 -0.034694,-4.845543c-1.561213,-2.162569 -3.099297,-4.336703 -4.648945,-6.510836c-3.15712,1.804068 -6.834644,2.64828 -10.454345,2.39386c-0.12721,0.786389 -0.277549,1.561213 -0.393194,2.347602c0.566662,0.589792 0.948292,1.37618 0.959857,2.197263c0.057823,1.283664 -0.717002,2.555763 -1.88502,3.064603c-1.353051,0.647614 -3.099297,0.185033 -3.955073,-1.029244c-0.925163,-1.214277 -0.797953,-3.076168 0.277549,-4.15167c0.277549,-0.300678 0.612921,-0.50884 0.959857,-0.705437c0.138774,-0.786389 0.277549,-1.572778 0.393194,-2.359166c-0.566662,-0.138774 -1.12176,-0.346936 -1.676858,-0.543533c-0.867341,1.723117 -1.711552,3.457798 -2.590457,5.180914c0.50884,0.971421 0.531969,2.197263 -0.011565,3.15712c-0.693872,1.306793 -2.347602,1.977536 -3.758476,1.526519c-1.422439,-0.404759 -2.440118,-1.873456 -2.301344,-3.342152c0.080952,-1.480261 1.306793,-2.77549 2.77549,-2.972087c0.867341,-1.734681 1.746246,-3.457798 2.590457,-5.204043c-1.653729,-1.040809 -3.133991,-2.347602 -4.371396,-3.850992c-0.948292,0.63605 -1.896585,1.272099 -2.833312,1.896585c-0.034694,1.202712 -0.751695,2.370731 -1.850327,2.879571c-1.329922,0.670743 -3.076168,0.25442 -3.966637,-0.936728c-0.99455,-1.225841 -0.878905,-3.168684 0.265984,-4.267316c0.89047,-0.925163 2.312908,-1.168019 3.504056,-0.740131c0.925163,-0.647614 1.88502,-1.260535 2.821748,-1.896585c-0.520404,-0.982986 -0.959857,-2.01223 -1.306793,-3.076168c-0.936728,0.196597 -1.873456,0.393194 -2.810183,0.601356c-0.265984,1.260535 -1.063938,2.405424 -2.185698,3.053039c-1.318358,0.797953 -3.041474,0.855776 -4.417655,0.161904c-1.434003,-0.693872 -2.416989,-2.174134 -2.567328,-3.758476l0,-0.693872c0.092516,-1.191148 0.63605,-2.336037 1.526519,-3.133991c1.098631,-1.006115 2.694538,-1.422439 4.140106,-1.075502c1.098631,0.242855 2.070053,0.913599 2.729232,1.815633c0.936728,-0.208162 1.873456,-0.404759 2.810183,-0.601356c-0.242855,-2.278215 -0.069387,-4.602687 0.520404,-6.811514c0.76326,-2.891135 2.26665,-5.562544 4.267316,-7.771371c-1.37618,-1.526519 -2.729232,-3.076168 -4.093847,-4.602687c-1.029244,0.150339 -2.127875,-0.150339 -2.9027,-0.855776c-1.214277,-1.063938 -1.50339,-3.006781 -0.63605,-4.371396c0.809518,-1.387745 2.64828,-2.035359 4.15167,-1.457132c1.665294,0.578227 2.671409,2.532634 2.13944,4.221057c1.353051,1.561213 2.740796,3.087732 4.093847,4.637381c1.491826,-1.075502 3.133991,-1.931278 4.880236,-2.532634c-0.185033,-0.786389 -0.358501,-1.572778 -0.543533,-2.347602c-1.318358,-0.531969 -2.208827,-1.954407 -2.023795,-3.376846c0.138774,-1.468697 1.387745,-2.717667 2.856442,-2.856442c1.491826,-0.196597 3.018345,0.797953 3.446233,2.231956c0.358501,1.087067 0.069387,2.312908 -0.682308,3.15712c0.185033,0.786389 0.358501,1.572778 0.555098,2.359166c2.891135,-0.370065 5.874787,-0.046258 8.615583,0.936728c0.138774,-0.289114 0.277549,-0.566662 0.404759,-0.855776c-0.589792,-1.040809 -0.555098,-2.405424 0.115645,-3.399975c0.740131,-1.168019 2.301344,-1.734681 3.631266,-1.318358c1.14489,0.335372 2.058488,1.341487 2.255085,2.52107c0.185033,0.971421 -0.115645,2.035359 -0.786389,2.763925c-0.485711,0.543533 -1.168019,0.89047 -1.873456,1.029244c-0.138774,0.289114 -0.277549,0.566662 -0.404759,0.855776c0.50884,0.312243 0.99455,0.647614 1.480261,1.006115c2.52107,-2.752361 5.053704,-5.504721 7.574774,-8.268647c-0.682308,-1.526519 -0.474146,-3.423104 0.578227,-4.729897c0.774824,-0.99455 1.954407,-1.607471 3.191813,-1.769375m-28.772577,20.596447c-1.746246,0.080952 -3.399975,1.133325 -4.267316,2.64828c-0.786389,1.353051 -0.936728,3.064603 -0.370065,4.5333c0.578227,1.572778 1.954407,2.833312 3.573443,3.2612c1.457132,0.404759 3.087732,0.150339 4.348267,-0.693872c1.260535,-0.832647 2.151005,-2.231956 2.336037,-3.735347c0.242855,-1.699987 -0.416323,-3.492491 -1.699987,-4.637381c-1.052373,-0.959857 -2.509505,-1.480261 -3.920379,-1.37618m11.911477,2.555763c-1.179583,0.12721 -2.289779,0.774824 -2.960522,1.75781c-0.705437,1.01768 -0.936728,2.347602 -0.578227,3.538749c0.38163,1.387745 1.549648,2.52107 2.937393,2.879571c1.665294,0.462582 3.573443,-0.25442 4.521735,-1.711552c1.052373,-1.514955 0.902034,-3.712218 -0.346936,-5.076833c-0.878905,-1.006115 -2.255085,-1.538084 -3.573443,-1.387745m-5.736012,9.760472c-0.612921,0.12721 -1.179583,0.462582 -1.595907,0.925163c-0.855776,0.925163 -1.01768,2.405424 -0.38163,3.480927c0.63605,1.191148 2.13944,1.815633 3.434669,1.422439c1.526519,-0.38163 2.52107,-2.093182 2.116311,-3.608137c-0.358501,-1.538084 -2.035359,-2.602022 -3.573443,-2.220392z');

		scope.enemy.append('path')
					.classed('lg', true)
					.attr('transform', 'scale(' + data.scale + ')')
					.attr('d', 'm32.334456,2.690708c-1.133325,0.196597 -1.88502,1.283664 -1.688423,2.416989c0.046258,0.289114 0.161904,0.543533 0.312243,0.774824l-2.682973,1.75781l-3.191813,-3.943508c0.566662,-0.462582 0.878905,-1.202712 0.740131,-1.965972c-0.196597,-1.133325 -1.272099,-1.896585 -2.405424,-1.699987c-1.133325,0.196597 -1.88502,1.283664 -1.688423,2.416989c0.138774,0.774824 0.682308,1.353051 1.37618,1.595907l-1.653729,4.78772l-3.122426,-0.728566c0.057823,-0.265984 0.069387,-0.555098 0.023129,-0.832647c-0.196597,-1.133325 -1.283664,-1.88502 -2.416989,-1.688423c-1.133325,0.196597 -1.88502,1.283664 -1.688423,2.416989s1.283664,1.88502 2.416989,1.688423c0.161904,-0.023129 0.312243,-0.080952 0.451017,-0.138774l2.798619,6.603353l0.242855,1.364616c0.138774,0.751695 0.855776,1.260535 1.607471,1.12176l9.563875,-1.688423c0.751695,-0.138774 1.260535,-0.855776 1.12176,-1.607471l-0.242855,-1.364616l0.370065,-7.170015c0.150339,0.011565 0.312243,0 0.474146,-0.023129c1.133325,-0.196597 1.88502,-1.283664 1.688423,-2.416989c-0.185033,-1.12176 -1.272099,-1.873456 -2.405424,-1.676858zm-8.673406,-1.283664c0.38163,-0.069387 0.740131,0.185033 0.809518,0.566662s-0.185033,0.740131 -0.566662,0.809518c-0.38163,0.069387 -0.740131,-0.185033 -0.809518,-0.566662c-0.069387,-0.38163 0.185033,-0.751695 0.566662,-0.809518zm-8.037356,6.348933c-0.069387,-0.38163 0.185033,-0.740131 0.566662,-0.809518c0.38163,-0.069387 0.740131,0.185033 0.809518,0.566662s-0.185033,0.740131 -0.566662,0.809518c-0.393194,0.057823 -0.751695,-0.196597 -0.809518,-0.566662zm17.196472,-2.336037c-0.38163,0.069387 -0.740131,-0.185033 -0.809518,-0.566662s0.185033,-0.740131 0.566662,-0.809518c0.38163,-0.069387 0.740131,0.185033 0.809518,0.566662s-0.185033,0.751695 -0.566662,0.809518z')
		}

		scope.enemy.intervalId = setInterval(function () {
			var r, x, y, width, height, enemyBody, clientRect, rockets;
			
			clientRect = scope.enemy.node().getBoundingClientRect();
			
			x = clientRect.left;
			y = clientRect.top;
			width = clientRect.width;
			height = clientRect.height;
			rockets = scope.canvas.selectAll('.rocket.active')
				.each(function () {
					var rocket = d3.select(this),
						clientRect = rocket.select('.rocket-body').node().getBoundingClientRect();
					
					var lives,
						damage,
						explosion;

					if ((clientRect.left >= x && clientRect.left <= x + width && clientRect.top >= y &&	clientRect.top <= y + height) 
						|| (clientRect.left + clientRect.width >= x && clientRect.left + clientRect.width <= x + width && clientRect.top + clientRect.height >= y && clientRect.top  + clientRect.height <= y + height)) {
						rocket
							.transition()
							.duration(0);
						
						rocket.remove();

						scope.canvas.append('circle')
							.attr('cx', clientRect.left)
							.attr('cy', clientRect.top)
							.attr('r', '5')
							.style('fill', 'rgba(0,0,0,0.1)')
								.transition()
								.duration(600)
									.attr('r', 35)
									.style('opacity', 0.15)
									.remove();

						explosion = d3.select(scope.explosion).select('#Page-1');

						explosion = scope.canvas.node()
							.appendChild(explosion.node().cloneNode(true));

						explosion = d3.select(explosion);

						explosion
							.attr('transform', 'translate(' +
								[clientRect.left + 10, clientRect.top + 10] +')')
							.style('opacity', 0)
							.transition()
							.duration(200)
								.style('opacity', 1);

						explosion
							.transition()
							.delay(200)
							.duration(500)
								.style('opacity', 0)
								.remove();

						damage = Math.round(Math.random() * 12 + 25);

						scope.canvas.append('text')
							.text(damage)
							.attr('x', clientRect.left + 10)
							.attr('y', clientRect.top - 5)
							.style('font-size', 20)
							.transition()
							.duration(1000)
								.style('opacity', 0)
								.style('font-size', 45)
								.remove();

						scope.shooter.updateScore(damage);
						scope.shooter.updateAccuracy({ hit: true });

						lives = parseInt(scope.enemy.attr('lives'), 10) - damage;
						scope.enemy.attr('lives', lives);

						if (lives <= 0) {
							scope.enemy.transition().duration(0);
							clearInterval(scope.enemy.intervalId);
							clearTimeout(scope.enemy.killSwitchId);

							scope.enemy
								.transition()
								.duration(600)
									.style('opacity', 0.1)
									.remove();

							scope.shooter.updateDestroyedCounter();
							scope.shooter.updateBacteriasScore(scope.enemy.attr('bacteria') ,1);
						}
					}
				});
		}, 30);

		scope.enemy.killSwitchId = setTimeout(function () {
			var lives = scope.enemy.attr('lives');

			clearInterval(scope.enemy.intervalId);

			if (lives > 0) {
				scope.shooter.updateHealth(lives);
			}
		}, t);

		scope.enemy
			.attr('intervalId', scope.enemy.intervalId)
			.attr('killSwitchId', scope.enemy.killSwitchId);
	};

	/* Helpers */
	scope.randomTime = function () {
		return Math.random() * 15000 + 10000;
	};

	scope.randomData = function () {
		return ENEMIES[Math.floor(Math.random() * 3)];
	};

	scope.randomX = function () {
		return Math.random() * scope.width;
	};

	scope.initEnemy();
};